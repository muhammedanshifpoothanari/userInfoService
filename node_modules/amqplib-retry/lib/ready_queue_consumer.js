'use strict';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value'in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}var config=require('./config');var Promise=require('bluebird');var ReadyQueueConsumer=function(){function ReadyQueueConsumer(channel){_classCallCheck(this,ReadyQueueConsumer);this.channel=channel}_createClass(ReadyQueueConsumer,[{key:'start',value:function start(){var self=this;return self.channel.consume(config.readyQueueName,function(msg){return Promise.try(function(){var targetQueueName=msg.properties.headers._targetQueue;var properties=msg.properties.headers._originalProperties;return self.channel.sendToQueue(targetQueueName,new Buffer(msg.content),properties)}).then(function(){return self.channel.ack(msg)}).catch(function(err){console.error('Error: while trying to process message from ready queue.  err: '+err+', msg: '+JSON.stringify(msg));self.channel.nack(msg)})})}}]);return ReadyQueueConsumer}();module.exports=ReadyQueueConsumer;
//# sourceMappingURL=ready_queue_consumer.js.map